!function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){!function(r){var n=t("./lib/cross-platform-text");e&&e.exports&&(e.exports=n),r&&(r.crossPlatformText=n)}(window)},{"./lib/cross-platform-text":3}],2:[function(t,e,r){var n={};e.exports=n},{}],3:[function(t,e,r){var n={canvas:t("./canvas"),svg:t("./svg"),getInstance:function(t){var e,r,n=t.targetSelector,i=document.querySelector(n),o=i.tagName,a=["div","section","p"];o&&a.indexOf(o.toLowerCase())>-1?(e=t.format,r=this[e].createTargetImage(s,i)):(e=o,r=i);var s=(this[e].getOrCreateViewport(this,r),Object.create(this));return s.targetImage=r,Object.keys(this[e]).forEach(function(t){s[t]||(s[t]="object"==typeof s[t]?Object.create(s[e][t]):s[e][t])}),s}};e.exports=n},{"./canvas":2,"./svg":4}],4:[function(t,e,r){var n=t("./utils"),i={xmlNS:"http://www.w3.org/XML/1998/namespace",svgNS:"http://www.w3.org/2000/svg",xmlnsNS:"http://www.w3.org/2000/xmlns/",xlinkNS:"http://www.w3.org/1999/xlink",evNS:"http://www.w3.org/2001/xml-events",createTargetImage:function(t,e){var r="svg-"+(new Date).toISOString().replace(/\D/g,""),n=document.createElementNS(this.svgNS,"svg");return n.setAttribute("xmlns",this.svgNS),n.setAttributeNS(this.xmlnsNS,"xmlns:xlink",this.xlinkNS),n.setAttributeNS(this.xmlnsNS,"xmlns:ev",this.evNS),n.setAttribute("id",r),n.setAttribute("version","1.1"),n.setAttribute("baseProfile","full"),n.setAttribute("preserveAspectRatio","xMidYMid"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),e.appendChild(n),this.targetImage=n,n},getOrCreateViewport:function(t,e){var r=e.querySelector("g.viewport");if(!r){var n="viewport-"+(new Date).toISOString().replace(/\D/g,"");r=document.createElementNS(this.svgNS,"g"),r.setAttribute("id",n),r.setAttribute("class","viewport");var i=e.childNodes||e.children;if(i&&i.length>0)do r.appendChild(i[0]);while(i.length>0);e.appendChild(r)}return r},render:function(t,e){t.color=t.color||"black",t.fontSize=t.fontSize||12,t.padding=t.padding||0;var r=(this.crossPlatformTextInstance,["fontSize"]),i=t.textContent.split(/\r\n|\r|\n|&#xA;/g),o=i.length,a=t.padding,s=t.width,l=t.height,c=t.fontSize,f=n.convertToPx(a,c);c=n.convertToPx(c,c);var u,g;"left"===t.textAlign?(u="start",g=f):"right"===t.textAlign?(u="end",g=s-f):(u="middle",g=s/2);var p,d=t.x+g,h=1.1*(o-1)*c;p="top"===t.verticalAlign?f+h/2+c*(2/3):"bottom"===t.verticalAlign?l-f-h/2-c*(2/3):l/2;var v=t.y+p,x="translate("+d+" "+v+")",m=document.createElementNS(this.svgNS,"g");m.setAttribute("transform",x),t.containerSelector?this.targetImage.querySelector(t.containerSelector).appendChild(m):this.targetImage.appendChild(m);var w=d3.select(m),S=(w.selectAll("text").data(i).enter().append("text").attr("id",function(t,e){return"text-line"+e}).attr("x",0).attr("y",function(t,e){return 1.1*(e-(o-1)/2)+"em"}).attr("dominant-baseline","central").attr("text-anchor",u).text(function(t){return t}),[]),b=t.backgroundColor||"transparent";S.push({name:"fill",value:b});var N,y,A={color:function(t){w.attr("fill",t)},id:function(t){w.attr("id","text-for-"+t)},fill:function(t){w.attr("fill",t)},fillOpacity:function(t){w.attr("fill-opacity",t)},fontFamily:function(t){w.attr("font-family",t)},fontSize:function(t){w.attr("font-size",t)},fontStyle:function(t){w.attr("font-style",t)},fontWeight:function(t){w.attr("font-weight",t)},rotation:function(t){x+=" rotate("+t+","+(s/2-g)+","+(l/2-p)+")",w.attr("transform",x)}},O=d3.map(t).entries().sort(function(t,e){return r.indexOf(t.key)-r.indexOf(e.key)});return O.forEach(function(t){N=t.key,y=t.value,A.hasOwnProperty(N)&&A[N](y)}),e?e(w[0][0]):w[0][0]}};e.exports=i},{"./utils":5}],5:[function(t,e,r){var n={isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},convertToPx:function(t,e){var r,n;return this.isNumber(t)?n=t:(r=t.toLowerCase(),n=r.indexOf("em")>-1?r.slice(0,r.length-2)*e:r.indexOf("px")>-1?r.slice(0,r.length-2):r.indexOf("pt")>-1?r.slice(0,r.length-2)*(4/3):r.indexOf("%")>-1?r.slice(0,r.length-1)/100*e:t),n}};e.exports=n},{}]},{},[1]);
//# sourceMappingURL=cross-platform-text-0.0.14.bundle.min.js.map